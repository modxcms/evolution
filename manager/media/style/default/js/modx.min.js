!function($,w,d,u){"use strict";modx.tree_parent=modx.tree_parent||0,modx.extended({frameset:"frameset",minWidth:840,isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),typesactions:{16:1,301:2,78:3,22:4,102:5,108:6,3:7,4:7,6:7,27:7,61:7,62:7,63:7,72:7},thememodes:["","lightness","light","dark","darkness"],tabsTimer:0,popupTimer:0,init:function(){if(localStorage.getItem("MODX_widthSideBar")||localStorage.setItem("MODX_widthSideBar",this.config.tree_width),this.mainmenu.init(),w.location.hash){var e=modx.getActionFromUrl(w.location.hash),t=modx.main.getQueryVariable("filemanager",w.location.hash);if(2==e)w.history.replaceState(null,d.title,modx.MODX_MANAGER_URL);else if(e||t){var o=w.location.href.replace("#","");modx.config.global_tabs?modx.tabs({url:o,title:"blank"}):w.main?w.main.frameElement.src=o:modx.openWindow(o)}}this.resizer.init(),this.search.init(),this.config.session_timeout>0&&w.setInterval(this.keepMeAlive,6e4*this.config.session_timeout),modx.config.mail_check_timeperiod>0&&modx.permission.messages&&setTimeout("modx.updateMail(true)",1e3),d.addEventListener("click",this.hideDropDown,!1),modx.config.global_tabs&&(d.addEventListener("click",this.tabs,!1),this.tabs({url:"?a=2",reload:0}))},mainmenu:{id:"mainMenu",init:function(){var e,t=$("#mainMenu"),o=d.getElementById("mainMenu");t.on("click","a",function(e){$(this).hasClass("dropdown-toggle")&&(t.hasClass("show")&&($(this).hasClass("selected")||!modx.isMobile&&$(this).parent().hasClass("hover"))?($(this).removeClass("selected"),t.removeClass("show")):($(".nav > li > a:not(:hover)").removeClass("selected"),$(this).addClass("selected"),t.addClass("show")),e.stopPropagation(),e.target.dataset.toggle="#mainMenu",modx.hideDropDown(e)),$(this).closest("ul").hasClass("dropdown-menu")&&!$(this).parent("li").hasClass("dropdown-back")&&($(".nav > .active").removeClass("active"),$(".nav li.selected").removeClass("selected"),$(this).closest(".nav > li").addClass("active"),this.offsetParent.id&&d.getElementById(this.offsetParent.id.substr(7)).classList.add("selected"),(modx.isMobile||w.innerWidth<modx.minWidth)&&$(e.target).hasClass("toggle")&&(this.parentNode.classList.add("selected"),e.stopPropagation(),e.preventDefault()))}).on("mouseenter",".nav > li",function(){for(var e=o.querySelectorAll(".nav > li.hover:not(:hover)"),t=0;t<e.length;t++)e[t].classList.remove("hover");this.classList.add("hover")}).on("click",".nav li",function(){(modx.isMobile||w.innerWidth<modx.minWidth)&&$(".nav ul.selected",t).removeClass("selected")}).on("mouseenter",".nav > li li",function(i){for(var s,n=this,a=o.querySelectorAll(".nav > li li.hover:not(:hover)"),r=0;r<a.length;r++)a[r].classList.remove("hover");this.classList.add("hover"),clearTimeout(e),this.offsetParent.nextElementSibling&&this.offsetParent.nextElementSibling.classList.contains("sub-menu")?s=this.offsetParent.nextElementSibling:this.offsetParent&&this.offsetParent.classList.contains("sub-menu")?s=this.offsetParent:(s=d.createElement("ul"),s.className="sub-menu dropdown-menu",this.parentNode.parentNode.appendChild(s)),e=setTimeout(function(){d.querySelector(".nav .sub-menu.show")&&d.querySelector(".nav .sub-menu.show").classList.remove("show"),s.style.left=n.offsetWidth+"px",n.classList.contains("dropdown-toggle")?s.id==="parent_"+n.id?(modx.isMobile?n.parentNode.classList.add("selected"):n.onclick=function(e){e.target.classList.contains("toggle")&&n.parentNode.classList.add("selected")},s.classList.add("show")):(s.classList.remove("show"),$(".nav ul.selected",t).removeClass("selected"),e=setTimeout(function(){var t=n.firstElementChild.href&&"main"===n.firstElementChild.target?n.firstElementChild.href.split("?")[1]+"&elements="+n.id:"";modx.post(modx.MODX_MANAGER_URL+"media/style/"+modx.config.theme+"/ajax.php",t,function(o){if(o){(modx.isMobile||w.innerWidth<modx.minWidth)&&(o='<li class="dropdown-back"><span class="dropdown-item"><i class="'+modx.style.icon_angle_left+'"></i>'+modx.lang.paging_prev+"</span></li>"+o),s.id="parent_"+n.id,s.innerHTML=o;var a=w.location.hash.substr(2).replace(/=/g,"_").replace(/&/g,"__"),r=d.getElementById(a);r&&(r.parentNode.classList.add("selected"),d.getElementById(r.parentNode.parentNode.id.substr(7)).classList.add("selected"));for(var l=0;l<s.children.length;l++)r=s.children[l],r.classList.contains("dropdown-back")&&(r.onclick=function(e){e.target.offsetParent.previousElementSibling.classList.remove("selected"),e.target.offsetParent.classList.remove("show"),e.preventDefault(),e.stopPropagation()}),r.onmouseenter=function(t){clearTimeout(e);var o=t.target.offsetParent.querySelector("li.hover");o&&o.classList.remove("hover"),t.target.classList.add("hover"),n.classList.add("hover"),t.preventDefault(),t.stopPropagation()};s.classList.add("show"),modx.isMobile?i.target.classList.contains("toggle")&&n.parentNode.classList.add("selected"):n.onclick=function(e){e.target.classList.contains("toggle")&&n.parentNode.classList.add("selected")},setTimeout(function(){modx.mainmenu.search(t,s)},200)}})},85)):s.classList.contains("open")&&(s.classList.remove("open"),setTimeout(function(){s.parentNode.removeChild(s)},100))},85),i.preventDefault()})},search:function(e,t){var o,i=t.querySelector("input[name=filter]"),s=-1,n=null;i&&(modx.isMobile||i.focus(),i.onkeyup=function(a){13===a.keyCode&&t.querySelector(".item.hover")?(d.body.click(),n=t.querySelector(".item.hover").firstChild,modx.tabs({url:n.href,title:n.innerHTML})):38===a.keyCode||40===a.keyCode?(i.selectionStart=i.value.length,o=t.querySelectorAll(".item"),o.length&&(40===a.keyCode?s++:s--,0>s?(s=-1,n=t.querySelector(".hover"),n&&n.classList.remove("hover")):s>o.length-1&&(s=o.length-1),s>=0&&s<o.length&&(n=t.querySelector(".hover"),n&&n.classList.remove("hover"),o[s].classList.add("hover")))):modx.post(modx.MODX_MANAGER_URL+"media/style/"+modx.config.theme+"/ajax.php",e+"&filter="+i.value,function(e){s=-1,$(".item",t).remove(),$(t).append(e).on("mouseenter",".item",function(e){$(this).addClass("hover").closest("ul").find("li:not(:hover)").removeClass("hover"),e.stopPropagation()})},"html")})}},search:{result:null,results:null,input:null,mask:null,loader:null,timer:0,init:function(){this.result=d.getElementById("searchresult"),this.input=d.getElementById("searchid"),this.mask=d.querySelector("#searchform .mask"),this.result||(this.result=d.createElement("div"),this.result.id="searchresult",d.body.appendChild(this.result)),this.loader=d.createElement("i"),this.loader.className=modx.style.icon_refresh+modx.style.icon_spin,this.input.parentNode.appendChild(this.loader),modx.config.global_tabs&&(this.input.parentNode.onsubmit=function(e){e.preventDefault(),this.target="mainsearch",modx.tabs({url:this.action,title:"Search",name:"mainsearch"}),this.submit()});var e=this;this.input.onkeyup=function(t){t.preventDefault(),clearTimeout(e.timer),""!==e.input.value.length&&e.input.value.length>2?e.timer=setTimeout(function(){e.loader.style.display="block",modx.get(modx.MODX_MANAGER_URL+"?a=71&ajax=1&submitok=Search&searchid="+e.input.value,function(t){e.loader.style.display="none",e.results=t.querySelector(".ajaxSearchResults"),e.results&&""!==e.results.innerHTML?(e.result.innerHTML=e.results.outerHTML,e.open(),e.result.onclick=function(t){var o=t.target,i=o.parentNode;if("I"===o.tagName)modx.openWindow({title:i.innerText,id:i.id,url:i.href}),t.preventDefault(),t.stopPropagation();else{var s="A"===o.tagName&&o||"A"===i.tagName&&i;if(s){var n=e.result.querySelector(".selected");n&&(n.className=""),s.className="selected",modx.isMobile&&e.close()}}}):e.empty()},"document")},300):e.empty()},modx.isMobile&&(this.input.onblur=this.close),this.input.onfocus=this.open,this.input.onclick=this.open,this.input.onmouseenter=this.open,this.result.onmouseenter=this.open,this.result.onmouseleave=this.close,this.mask.onmouseenter=this.open,this.mask.onmouseleave=this.close},open:function(){modx.search.results&&modx.search.result.classList.add("open")},close:function(){modx.search.result.classList.remove("open")},empty:function(){modx.search.result.classList.remove("open"),modx.search.result.innerHTML=""}},main:{id:"main",idFrame:"mainframe",as:null,getAjaxUrl:function(){var e=modx.getActionFromUrl(w.main.location.href);if(modx.isDashboard(e))return modx.MODX_MANAGER_URL;var t;return t=parseInt(e)===e?"#"+w.main.location.search:modx.MODX_MANAGER_URL+"#"+e+w.main.location.search},onload:function(e){w.main=e.target.contentWindow||e.target.defaultView,modx.main.tabRow.init(),modx.main.stopWork(),modx.main.scrollWork(),w.main.document.addEventListener("click",modx.hideDropDown,!1),w.main.document.addEventListener("contextmenu",modx.main.oncontextmenu,!1),modx.config.global_tabs&&w.main.document.addEventListener("click",modx.tabs,!1),w.history.replaceState(null,d.title,modx.main.getAjaxUrl()),setTimeout("modx.tree.restoreTree()",100)},oncontextmenu:function(e){if(!e.ctrlKey){var t=e.target;if(1===modx.user.role&&/modxtv|modxplaceholder|modxattributevalue|modxchunk|modxsnippet|modxsnippetnocache/i.test(t.className)){var o=Date.now(),i=t.innerText.replace(/[\[|\]|{|}|\*||\#|\+|?|\!|&|=|`|:]/g,""),s=t.className.replace(/cm-modx/,""),n=!!i.replace(/^\d+$/,"");i&&n&&(e.preventDefault(),modx.post(modx.MODX_MANAGER_URL+"media/style/"+modx.config.theme+"/ajax.php",{a:"modxTagHelper",name:i,type:s},function(s){if(s){s=JSON.parse(s);for(var n in s)s.hasOwnProperty(n)&&s[n].url&&(s[n].onclick="if(event.shiftKey){modx.openWindow({url:'"+s[n].url+"'})}else{modx.popup({url:'"+s[n].url+"',title:'"+s.header.innerHTML+"',width:'95%',height:'95%',margin:0,hide:0,hover:0,overlay:1,overlayclose:0,position:'center elements',animation:0,icon:'none'})}");s=JSON.stringify(s),t.id="node"+o,t.dataset.contextmenu=s,modx.tree.showPopup(e,o,i)}})),e.preventDefault()}}},tabRow:{init:function(){var e=w.main.document.querySelector(".tab-pane > .tab-row");e&&this.build(e)},build:function(e){var t=d.createElement("div"),o=e.querySelector(".selected");t.className="tab-row-container",e.parentNode.insertBefore(t,e),t.appendChild(e);var i=d.createElement("i");i.className=modx.style.icon_angle_left+" prev disable",i.onclick=function(t){t.stopPropagation(),t.preventDefault();var o=e.querySelector(".selected");o.previousSibling&&(o.previousSibling.click(),modx.main.tabRow.scroll(e))},t.appendChild(i);var s=d.createElement("i");s.className=modx.style.icon_angle_right+" next disable",s.onclick=function(t){t.stopPropagation(),t.preventDefault();var o=e.querySelector(".selected");o.nextSibling&&(o.nextSibling.click(),modx.main.tabRow.scroll(e))},t.appendChild(s),setTimeout(function(){o=e.querySelector(".selected"),modx.main.tabRow.scroll(e,o),w.main.addEventListener("resize",function(){modx.main.tabRow.scroll(e)},!1),o&&(o.previousSibling&&i.classList.remove("disable"),o.nextSibling&&s.classList.remove("disable"))},100),e.onclick=function(e){var t="H2"===e.target.tagName?e.target:"SPAN"===e.target.tagName?e.target.parentNode:null;t&&(t.previousSibling?this.parentNode.querySelector("i.prev").classList.remove("disable"):this.parentNode.querySelector("i.prev").classList.add("disable"),t.nextSibling?this.parentNode.querySelector("i.next").classList.remove("disable"):this.parentNode.querySelector("i.next").classList.add("disable"),modx.main.tabRow.scroll(this,t))}},scroll:function(e,t,o){t=t||e.querySelector(".selected")||e.firstChild,o=o||100;for(var i=0,s=e.childNodes,n=0;n<s.length;n++)i+=s[n].offsetWidth;e.scrollLeft>t.offsetLeft&&$(e).animate({scrollLeft:t.offsetLeft-(t.previousSibling?30:1)},o),t.offsetLeft+t.offsetWidth>e.offsetWidth+e.scrollLeft&&$(e).animate({scrollLeft:t.offsetLeft-e.offsetWidth+t.offsetWidth+(t.nextSibling?30:0)},o),i>e.offsetWidth&&this.drag(e)},drag:function(e){e.onmousedown=function(t){if(0===t.button){t.preventDefault();var o=t.clientX,i=e.scrollLeft;e.ownerDocument.body.focus(),e.onmousemove=e.ownerDocument.onmousemove=function(t){Math.abs(t.clientX-o)>5&&(t.stopPropagation(),e.scrollLeft=i-(t.clientX-o),e.ownerDocument.body.classList.add("drag"))},e.onmouseup=e.ownerDocument.onmouseup=function(t){t.stopPropagation(),e.onmousemove=null,e.ownerDocument.onmousemove=null,e.ownerDocument.body.classList.remove("drag")}}}}},work:function(){d.getElementById("mainloader").classList.add("show"),setTimeout(function(e){e.stopWork()},3e3,this)},stopWork:function(){d.getElementById("mainloader").classList.remove("show")},scrollWork:function(){var e=w.main.frameElement.contentWindow,t=e.location.search.substring(1)||e.location.hash.substring(2),o=localStorage.getItem("page_y")||0,i=localStorage.getItem("page_url")||t;(modx.getActionFromUrl(i)===modx.getActionFromUrl(t)&&modx.main.getQueryVariable("id",i)&&modx.main.getQueryVariable("id",i)===modx.main.getQueryVariable("id",t)||i===t)&&e.scrollTo(0,o),e.addEventListener("scroll",function(){this.pageYOffset>=0&&(localStorage.setItem("page_y",this.pageYOffset.toString()),localStorage.setItem("page_url",t))},!1)},getQueryVariable:function(e,t){var o="";if(t||"string"==typeof t){t=t.split("?"),t=t[1]||t[0],t=t.split("&");for(var i=0;i<t.length;i++){var s=t[i].split("=");s[0]===e&&(o=decodeURIComponent(s[1]))}}return o}},resizer:{dragElement:null,oldZIndex:99,newZIndex:999,left:modx.config.tree_width,id:"resizer",switcher:"hideMenu",background:"rgba(0, 0, 0, 0.1)",mask:null,init:function(){if(d.getElementById(modx.resizer.id)&&(modx.resizer.mask=d.createElement("div"),modx.resizer.mask.id="mask_resizer",modx.resizer.mask.style.zIndex=modx.resizer.oldZIndex,d.getElementById(modx.resizer.id).onmousedown=modx.resizer.onMouseDown,d.getElementById(modx.resizer.id).onmouseup=modx.resizer.mask.onmouseup=modx.resizer.onMouseUp,modx.isMobile)){var e,t,o=d.getElementById("tree"),i=o.offsetWidth;d.getElementById("frameset").appendChild(modx.resizer.mask),w.addEventListener("touchstart",function(o){/tab|tab\-row|tab\-row\-container/.test(o.target.className||o.target.offsetParent.className)?this.swipe=!1:(e=o.changedTouches[0].clientX,t=o.changedTouches[0].clientY,this.swipe=!0,this.sidebar=!d.body.classList.contains("sidebar-closed"))},!1),w.addEventListener("touchmove",function(s){var n=s.changedTouches[0];o.style.transition="none",o.style.WebkitTransition="none",modx.resizer.mask.style.transition="none",modx.resizer.mask.style.WebkitTransition="none",modx.resizer.mask.style.visibility="visible";var a=n.clientX-e,r=n.clientY-t;Math.abs(a)>Math.abs(r)&&this.swipe&&(0>a&&this.sidebar?(Math.abs(a)>i&&(a=-i),o.style.transform="translate3d("+a+"px, 0, 0)",o.style.WebkitTransform="translate3d("+a+"px, 0, 0)",modx.resizer.mask.style.opacity=(.5-.5/-i*a).toFixed(2),Math.abs(a)>i/3?this.swipe="left":this.swipe="right"):a>0&&!this.sidebar&&(Math.abs(a)>i&&(a=i),o.style.transform="translate3d("+-(i-a)+"px, 0, 0)",o.style.WebkitTransform="translate3d("+-(i-a)+"px, 0, 0)",modx.resizer.mask.style.opacity=(.5/i*a).toFixed(2),Math.abs(a)>i/3?this.swipe="right":this.swipe="left"))},!1),w.addEventListener("touchend",function(){"left"===this.swipe&&(d.body.classList.add("sidebar-closed"),modx.resizer.setWidth(0)),"right"===this.swipe&&(d.body.classList.remove("sidebar-closed"),modx.resizer.setWidth(i)),o.style.cssText="",modx.resizer.mask.style.cssText=""},!1)}},onMouseDown:function(e){return e=e||w.event,modx.resizer.dragElement=null!==e.target?e.target:e.srcElement,1!==e.buttons&&0!==e.button||modx.resizer.dragElement.id!==modx.resizer.id?void 0:(modx.resizer.oldZIndex=modx.resizer.dragElement.style.zIndex,modx.resizer.dragElement.style.zIndex=modx.resizer.newZIndex,modx.resizer.dragElement.style.background=modx.resizer.background,localStorage.setItem("MODX_widthSideBar",modx.resizer.dragElement.offsetLeft>0?modx.resizer.dragElement.offsetLeft:0),d.body.appendChild(modx.resizer.mask),d.onmousemove=modx.resizer.onMouseMove,d.body.focus(),d.body.classList.add("resizer_move"),d.onselectstart=function(){return!1},modx.resizer.dragElement.ondragstart=function(){return!1},!1)},onMouseMove:function(e){e=e||w.event,e.clientX>0?modx.resizer.left=e.clientX:modx.resizer.left=0,modx.resizer.dragElement.style.left=modx.pxToRem(modx.resizer.left)+"rem",d.getElementById("tree").style.width=modx.pxToRem(modx.resizer.left)+"rem",d.getElementById("main").style.left=modx.pxToRem(modx.resizer.left)+"rem",(e.clientX<-2||e.clientY<-2)&&modx.resizer.onMouseUp(e)},onMouseUp:function(e){null!==modx.resizer.dragElement&&0===e.button&&modx.resizer.dragElement.id===modx.resizer.id&&(e.clientX>0?(d.body.classList.remove("sidebar-closed"),modx.resizer.left=e.clientX):(d.body.classList.add("sidebar-closed"),modx.resizer.left=0),d.cookie="MODX_widthSideBar="+modx.pxToRem(modx.resizer.left),modx.resizer.dragElement.style.zIndex=modx.resizer.oldZIndex,modx.resizer.dragElement.style.background="",modx.resizer.dragElement.ondragstart=null,modx.resizer.dragElement=null,d.body.classList.remove("resizer_move"),d.body.removeChild(modx.resizer.mask),d.onmousemove=null,d.onselectstart=null)},toggle:function(){if(modx.isMobile||w.innerWidth<=modx.minWidth)d.body.classList.contains("sidebar-closed")?(d.body.classList.remove("sidebar-closed"),localStorage.setItem("MODX_widthSideBar",0),d.cookie="MODX_widthSideBar="+modx.pxToRem(parseInt(d.getElementById("tree").offsetWidth))):(localStorage.setItem("MODX_widthSideBar",parseInt(d.getElementById("tree").offsetWidth)),d.body.classList.add("sidebar-closed"),d.cookie="MODX_widthSideBar=0");else{var e=0!==d.getElementById("tree").offsetWidth?0:parseInt(localStorage.getItem("MODX_widthSideBar"))?parseInt(localStorage.getItem("MODX_widthSideBar")):modx.config.tree_width;modx.resizer.setWidth(e)}},setWidth:function(e){e>0?(localStorage.setItem("MODX_widthSideBar",0),d.body.classList.remove("sidebar-closed")):(localStorage.setItem("MODX_widthSideBar",parseInt(d.getElementById("tree").offsetWidth)),d.body.classList.add("sidebar-closed")),d.cookie="MODX_widthSideBar="+modx.pxToRem(e),d.getElementById("tree").style.width=modx.pxToRem(e)+"rem",d.getElementById("resizer").style.left=modx.pxToRem(e)+"rem",d.getElementById("main").style.left=modx.pxToRem(e)+"rem"},setDefaultWidth:function(){modx.resizer.setWidth(modx.remToPx(modx.config.tree_width))}},tree:{ctx:null,rpcNode:null,itemToChange:"",selectedObjectName:null,selectedObject:0,selectedObjectDeleted:0,selectedObjectUrl:"",drag:!1,deleted:[],init:function(){this.restoreTree()},draggable:function(){if(modx.permission.dragndropdocintree)for(var e=d.querySelectorAll("#treeRoot a:not(.empty)"),t=0;t<e.length;t++){var o=e[t];o.onmousedown=this.onmousedown,o.ondragstart=this.ondragstart,o.ondragenter=this.ondragenter,o.ondragover=this.ondragover,o.ondragleave=this.ondragleave,o.ondrop=this.ondrop}},onmousedown:function(e){if(e.ctrlKey)return this.parentNode.removeAttribute("draggable"),!0;var t=this.dataset.roles+("treeRoot"!==this.parentNode.parentNode.id?this.parentNode.parentNode.previousSibling.dataset.roles:""),o=!1;o=""!=t?t.split(",").map(Number).filter(function(e){return~modx.user.groups.indexOf(parseInt(e))}).length:!0;var i=t&&1!==modx.user.role?o:!0;modx.tree.itemToChange=this.dataset.id||this.parentNode.id.replace("node",""),modx.tree.selectedObjectName=this.dataset.titleEsc,i?(this.parentNode.draggable=!0,this.parentNode.ondragstart=modx.tree.ondragstart):(this.parentNode.draggable=!1,this.parentNode.ondragstart=function(){return!1})},ondragstart:function(e){e.dataTransfer.effectAllowed="all",e.dataTransfer.dropEffect="all",e.dataTransfer.setData("text",this.id.substr(4))},ondragenter:function(e){d.getElementById("node"+modx.tree.itemToChange)===(this.parentNode.closest("#node"+modx.tree.itemToChange)||this.parentNode)?(this.parentNode.className="",e.dataTransfer.effectAllowed="none",e.dataTransfer.dropEffect="none",modx.tree.drag=!1):(this.parentNode.className="dragenter",e.dataTransfer.effectAllowed="copy",e.dataTransfer.dropEffect="copy",modx.tree.drag=!0),e.preventDefault()},ondragover:function(e){if(modx.tree.drag){var t=e.clientY,o=parseInt(this.getBoundingClientRect().top),i=t-o;i>this.offsetHeight/1.51?(this.parentNode.classList.add("dragafter"),this.parentNode.classList.remove("dragbefore"),this.parentNode.classList.remove("dragenter"),e.dataTransfer.effectAllowed="move",e.dataTransfer.dropEffect="move"):i<this.offsetHeight/3?(this.parentNode.classList.add("dragbefore"),this.parentNode.classList.remove("dragafter"),this.parentNode.classList.remove("dragenter"),e.dataTransfer.effectAllowed="move",e.dataTransfer.dropEffect="move"):(this.parentNode.classList.add("dragenter"),this.parentNode.classList.remove("dragafter"),this.parentNode.classList.remove("dragbefore"),e.dataTransfer.effectAllowed="copy",e.dataTransfer.dropEffect="copy")}else e.dataTransfer.effectAllowed="none",e.dataTransfer.dropEffect="none",modx.tree.drag=!1;e.preventDefault()},ondragleave:function(e){this.parentNode.className="",this.parentNode.removeAttribute("draggable"),e.preventDefault()},ondrop:function(e){var t=d.getElementById("node"+modx.tree.itemToChange),o=null,i=modx.tree.itemToChange,s=0,n=[],a=0,r=t.firstChild.querySelector(".indent"),l=0;if(r.innerHTML="",t.removeAttribute("draggable"),this.parentNode.classList.contains("dragenter")){for(s=parseInt(this.parentNode.id.substr(4)),a=parseInt(this.dataset.level)+1,l=0;a>l;l++)r.innerHTML+="<i></i>";if(this.nextSibling)for(this.nextSibling.innerHTML?this.nextSibling.appendChild(t):t.parentNode.removeChild(t),o=this.parentNode.lastChild.children,l=0;l<o.length;l++)n[l]=o[l].id.substr(4);else t.parentNode.removeChild(t),d.querySelector("#node"+s+" .icon").innerHTML=parseInt(this.dataset["private"])?modx.style.icon_folder:modx.style.icon_folder;modx.tree.ondragupdate(this,i,s,n)}if(this.parentNode.classList.contains("dragafter")){for(s=/node/.test(this.parentNode.parentNode.parentNode.id)?parseInt(this.parentNode.parentNode.parentNode.id.substr(4)):0,a=parseInt(this.dataset.level),l=0;a>l;l++)r.innerHTML+="<i></i>";for(this.parentNode.parentNode.insertBefore(t,this.parentNode.nextSibling),o=this.parentNode.parentNode.children,l=0;l<o.length;l++)n[l]=o[l].id.substr(4);modx.tree.ondragupdate(this,i,s,n)}if(this.parentNode.classList.contains("dragbefore")){for(s=/node/.test(this.parentNode.parentNode.parentNode.id)?parseInt(this.parentNode.parentNode.parentNode.id.substr(4)):0,a=parseInt(this.dataset.level),l=0;a>l;l++)r.innerHTML+="<i></i>";for(this.parentNode.parentNode.insertBefore(t,this.parentNode),o=this.parentNode.parentNode.children,l=0;l<o.length;l++)n[l]=o[l].id.substr(4);modx.tree.ondragupdate(this,i,s,n)}this.parentNode.removeAttribute("class"),this.parentNode.removeAttribute("draggable"),e.preventDefault()},ondragupdate:function(e,t,o,i){var s=e.dataset.roles+("treeRoot"!==e.parentNode.parentNode.id?e.parentNode.parentNode.previousSibling.dataset.roles:""),n=!1;if(""!=s)n=s.split(",").map(Number).filter(function(e){return~modx.user.groups.indexOf(parseInt(e))}).length;else var n=!0;if(!(s&&1!==modx.user.role?n:!0))return alert(modx.lang.error_no_privileges),void modx.tree.restoreTree();modx.post(modx.MODX_MANAGER_URL+"media/style/"+modx.config.theme+"/ajax.php",{a:"movedocument",id:t,parent:o,menuindex:i},function(e){e.errors&&alert(e.errors),modx.tree.restoreTree()},"json");var a=w.main.frameElement.contentWindow.location.search.substr(1);if(modx.getActionFromUrl(a,27)&&parseInt(modx.main.getQueryVariable("id",a))===parseInt(t)){var r=i.indexOf(t),l=w.main.document.querySelector("#documentPane input[name=menuindex]"),m=w.main.document.querySelector("#documentPane input[name=parent]"),c=w.main.document.querySelector("#documentPane #parentName");l&&r>=0&&(l.value=r),m&&c&&(m.value=o,c.innerHTML=o+" ("+d.querySelector("#node"+o+" > a").dataset.titleEsc+")")}},toggleTheme:function(){var e,t,o=1,i=w.main.myCodeMirrors;"undefined"==typeof localStorage.MODX_themeMode&&(localStorage.MODX_themeMode=modx.config.theme_mode),modx.thememodes[parseInt(localStorage.MODX_themeMode)+1]&&(o=parseInt(localStorage.MODX_themeMode)+1),e=modx.thememodes[o];for(t in modx.thememodes)modx.thememodes[t]&&(d.body.classList.remove(modx.thememodes[t]),w.main.document.body.classList.remove(modx.thememodes[t]));if(d.body.classList.add(e),w.main.document.body.classList.add(e),d.cookie="MODX_themeMode="+o,localStorage.MODX_themeMode=o,"undefined"!=typeof i)for(t in i)i.hasOwnProperty(t)&&(~e.indexOf("dark")?(w.main.document.getElementsByName(t)[0].nextElementSibling.classList.add("cm-s-"+i[t].options.darktheme),w.main.document.getElementsByName(t)[0].nextElementSibling.classList.remove("cm-s-"+i[t].options.defaulttheme)):(w.main.document.getElementsByName(t)[0].nextElementSibling.classList.remove("cm-s-"+i[t].options.darktheme),w.main.document.getElementsByName(t)[0].nextElementSibling.classList.add("cm-s-"+i[t].options.defaulttheme)))},toggleNode:function(e,t){if(e=e||w.event,!e.ctrlKey){e.stopPropagation();var o=d.getElementById("node"+t).firstChild;this.rpcNode=o.nextSibling;var i=o.querySelector(".toggle"),s=o.querySelector(".icon");if(""===this.rpcNode.innerHTML){i&&(i.innerHTML=o.dataset.iconCollapsed),s.innerHTML=o.dataset.iconFolderOpen;var n=this.rpcNode.innerHTML,a=modx.lang.loading_doc_tree;if(modx.openedArray[t]=1,""===n||n.indexOf(a)>0){var r=this.getFolderState();d.getElementById("treeloader").classList.add("visible"),modx.post(modx.MODX_MANAGER_URL+"media/style/"+modx.config.theme+"/ajax.php","a=1&f=nodes&indent="+o.dataset.indent+"&parent="+t+"&expandAll="+o.dataset.expandall+r,function(e){modx.tree.rpcLoadData(e),modx.tree.draggable()})}this.saveFolderState()}else i&&(i.innerHTML=o.dataset.iconExpanded),s.innerHTML=o.dataset.iconFolderClose,delete modx.openedArray[t],this.rpcNode.style.overflow="hidden",$(this.rpcNode.firstChild).animate({marginTop:-this.rpcNode.offsetHeight+"px"},100,function(){this.parentNode.innerHTML=""}),this.saveFolderState();e.preventDefault()}},rpcLoadData:function(e){if(null!==this.rpcNode){var t;this.rpcNode.innerHTML="object"==typeof e?e.responseText:e,this.rpcNode.loaded=!0,"DIV"===this.rpcNode.firstChild.tagName?("treeRoot"===this.rpcNode.id?(t=d.getElementById("binFull"),t?this.showBin(!0):this.showBin(!1)):(this.rpcNode.style.overflow="hidden",this.rpcNode.firstElementChild.style.marginTop=-this.rpcNode.offsetHeight+"px",$(this.rpcNode.firstChild).animate({marginTop:0},100)),d.getElementById("treeloader").classList.remove("visible")):(t=d.getElementById("loginfrm"),t&&(this.rpcNode.parentNode.removeChild(this.rpcNode),w.location.href=modx.MODX_MANAGER_URL))}},treeAction:function(e,t,o){if(!e.ctrlKey){var i=d.getElementById("node"+t).firstChild,s=i.dataset.treepageclick,n=parseInt(i.dataset.showchildren),a=parseInt(i.dataset.openfolder);if(o=o||i.dataset&&i.dataset.titleEsc,"move"===tree.ca)try{this.setSelectedByContext(t),w.main.setMoveValue(t,o)}catch(r){alert(modx.lang.unable_set_parent)}if("open"===tree.ca||""===tree.ca){var l;0===t?l="?a=2":(l="",l=!isNaN(s)&&isFinite(s)?"?a="+s+"&r=1&id="+t+(0===a?this.getFolderState():""):s,2===a&&(1!==n&&(l=""),this.toggleNode(e,t))),l&&(e.shiftKey?(w.getSelection().removeAllRanges(),modx.openWindow(l),this.restoreTree()):(l.startsWith(modx.MODX_MANAGER_URL)||(l=modx.MODX_MANAGER_URL+l),modx.tabs({url:l,title:o+"<small>("+t+")</small>"}),modx.isMobile&&w.innerWidth<modx.minWidth&&modx.resizer.toggle())),this.itemToChange=t,this.setSelected(t)}if("parent"===tree.ca)try{this.setSelectedByContext(t),w.main.setParent(t,o)}catch(r){alert(modx.lang.unable_set_parent)}if("link"===tree.ca)try{this.setSelectedByContext(t),w.main.setLink(t)}catch(r){alert(modx.lang.unable_set_link)}e.preventDefault()}},showPopup:function(e,id,title){if(!e.ctrlKey){e.preventDefault();var tree=d.getElementById("tree"),el=d.getElementById("node"+id)||e.target,x=0,y=0;if(el.firstChild&&el.firstChild.dataset&&el.firstChild.dataset.contextmenu&&(el=el.firstChild),el){if(el.dataset.contextmenu){e.target.dataset.toggle="#contextmenu",modx.hideDropDown(e),this.ctx=d.createElement("div"),this.ctx.id="contextmenu",this.ctx.className="dropdown-menu",d.getElementById(modx.frameset).appendChild(this.ctx),this.setSelectedByContext(id);var dataJson=JSON.parse(el.dataset.contextmenu);for(var key in dataJson)if(dataJson.hasOwnProperty(key)){var item=d.createElement("div");for(var k in dataJson[key])if(dataJson[key].hasOwnProperty(k))if("on"===k.substring(0,2)){var onEvent=dataJson[key][k];item[k]=function(onEvent){return function(event){eval(onEvent)}}(onEvent)}else item[k]=dataJson[key][k];0===key.indexOf("header")&&(item.className+=" menuHeader"),0===key.indexOf("item")&&(item.className+=" menuLink"),0!==key.indexOf("seperator")&&0!==key.indexOf("separator")||(item.className+=" seperator separator"),this.ctx.appendChild(item)}x=e.clientX>0?e.clientX:e.pageX,y=e.clientY>0?e.clientY:e.pageY,e.view.position=e.view.frameElement?e.view.frameElement.getBoundingClientRect():e.target.offsetParent.getBoundingClientRect(),e.view.frameElement?(x+=e.view.position.left,y+=e.view.frameElement.offsetParent.offsetTop):e.target.parentNode.parentNode.classList.contains("node")&&(x+=50),x>e.view.position.width&&(x=e.view.position.width-this.ctx.offsetWidth),y+this.ctx.offsetHeight/2>e.view.position.height?y=e.view.position.height-this.ctx.offsetHeight-5:y-this.ctx.offsetHeight/2<e.view.position.top?y=e.view.position.top+5:y-=this.ctx.offsetHeight/2,this.itemToChange=id,this.selectedObjectName=title,this.dopopup(this.ctx,x+10,y)}else{el=el.firstChild;var ctx=d.getElementById("mx_contextmenu");e.target.dataset.toggle="#mx_contextmenu",modx.hideDropDown(e),this.setSelectedByContext(id);var i4=d.getElementById("item4"),i5=d.getElementById("item5"),i8=d.getElementById("item8"),i9=d.getElementById("item9"),i10=d.getElementById("item10"),i11=d.getElementById("item11");1===modx.permission.publish_document?(i9.style.display="block",i10.style.display="block",1===parseInt(el.dataset.published)?i9.style.display="none":i10.style.display="none"):i5&&(i5.style.display="none"),1===modx.permission.delete_document&&(i4.style.display="block",i8.style.display="block",1===parseInt(el.dataset.deleted)?(i4.style.display="none",i9.style.display="none",i10.style.display="none"):i8.style.display="none"),i11&&(1===parseInt(el.dataset.isfolder)?i11.style.display="block":i11.style.display="none");var bodyHeight=tree.offsetHeight+tree.offsetTop;x=e.clientX>0?e.clientX:e.pageX,y=e.clientY>0?e.clientY:e.pageY,y+ctx.offsetHeight/2>bodyHeight?y=bodyHeight-ctx.offsetHeight-5:y-ctx.offsetHeight/2<tree.offsetTop?y=tree.offsetTop+5:y-=ctx.offsetHeight/2,e.target.parentNode.parentNode.classList.contains("node")&&(x+=50),this.itemToChange=id,this.selectedObjectName=title,ctx.classList.contains("show")?(ctx.classList.remove("show"),setTimeout(function(){modx.tree.dopopup(ctx,x+10,y)},100)):this.dopopup(ctx,x+10,y)}e.stopPropagation()}}},dopopup:function(e,t,o){this.selectedObjectName.length>30&&(this.selectedObjectName=this.selectedObjectName.substr(0,30)+"...");var i=d.getElementById("nameHolder");i.innerHTML=this.selectedObjectName,e.style.left=t+("rtl"===modx.config.textdir?"-190":"")+"px",e.style.top=o+"px",e.classList.add("show")},menuHandler:function(e){switch(e){case 1:this.setActiveFromContextMenu(this.itemToChange),modx.tabs({url:modx.MODX_MANAGER_URL+"?a=3&id="+this.itemToChange,title:this.selectedObjectName+"<small>("+this.itemToChange+")</small>"});break;case 2:this.setActiveFromContextMenu(this.itemToChange),modx.tabs({url:modx.MODX_MANAGER_URL+"?a=27&r=1&id="+this.itemToChange,title:this.selectedObjectName+"<small>("+this.itemToChange+")</small>"});break;case 3:modx.tabs({url:modx.MODX_MANAGER_URL+"?a=4&pid="+this.itemToChange,title:this.selectedObjectName+"<small>("+this.itemToChange+")</small>"});break;case 4:this.selectedObjectDeleted?alert('"'+this.selectedObjectName+'" '+modx.lang.already_deleted):confirm('"'+this.selectedObjectName+'"\n\n'+modx.lang.confirm_delete_resource)===!0&&modx.tabs({url:modx.MODX_MANAGER_URL+"?a=6&id="+this.itemToChange,title:this.selectedObjectName+"<small>("+this.itemToChange+")</small>"});break;case 5:this.setActiveFromContextMenu(this.itemToChange),
modx.tabs({url:modx.MODX_MANAGER_URL+"?a=51&id="+this.itemToChange,title:this.selectedObjectName+"<small>("+this.itemToChange+")</small>"});break;case 6:modx.tabs({url:modx.MODX_MANAGER_URL+"?a=72&pid="+this.itemToChange,title:this.selectedObjectName+"<small>("+this.itemToChange+")</small>"});break;case 7:confirm(modx.lang.confirm_resource_duplicate)===!0&&modx.tabs({url:modx.MODX_MANAGER_URL+"?a=94&id="+this.itemToChange,title:this.selectedObjectName+"<small>("+this.itemToChange+")</small>"});break;case 8:d.getElementById("node"+this.itemToChange).firstChild.dataset.deleted?confirm('"'+this.selectedObjectName+'" '+modx.lang.confirm_undelete)===!0&&modx.tabs({url:modx.MODX_MANAGER_URL+"?a=63&id="+this.itemToChange,title:this.selectedObjectName+"<small>("+this.itemToChange+")</small>"}):alert('"'+this.selectedObjectName+'"'+modx.lang.not_deleted);break;case 9:confirm('"'+this.selectedObjectName+'" '+modx.lang.confirm_publish)===!0&&modx.tabs({url:modx.MODX_MANAGER_URL+"?a=61&id="+this.itemToChange,title:this.selectedObjectName+"<small>("+this.itemToChange+")</small>"});break;case 10:this.itemToChange!==modx.config.site_start?confirm('"'+this.selectedObjectName+'" '+modx.lang.confirm_unpublish)===!0&&modx.tabs({url:modx.MODX_MANAGER_URL+"?a=62&id="+this.itemToChange,title:this.selectedObjectName+"<small>("+this.itemToChange+")</small>"}):alert("Document is linked to site_start variable and cannot be unpublished!");break;case 11:modx.tabs({url:modx.MODX_MANAGER_URL+"?a=56&id="+this.itemToChange,title:this.selectedObjectName+"<small>("+this.itemToChange+")</small>"});break;case 12:w.open(d.getElementById("node"+this.itemToChange).firstChild.dataset.href,"previeWin");break;default:alert("Unknown operation command.")}},setSelected:function(e){var t=d.querySelector("#tree .current");t&&t.classList.remove("current"),e&&("object"==typeof e?e.classList.add("current"):(t=d.querySelector("#node"+e+">.node")||d.getElementById("node"+e),t&&t.classList.add("current")))},setActiveFromContextMenu:function(e){var t=d.querySelector("#node"+e+">.node");t&&this.setSelected(t)},setSelectedByContext:function(e){var t=d.querySelector("#treeRoot .selected");t&&t.classList.remove("selected"),t=d.querySelector("#node"+e+">.node"),t&&t.classList.add("selected")},setItemToChange:function(){var e=w.main.document&&(w.main.document.URL||w.main.document.location.href),t=modx.getActionFromUrl(e);e&&modx.typesactions[t]?this.itemToChange=(7===modx.typesactions[t]?"":modx.typesactions[t]+"_")+parseInt(modx.main.getQueryVariable("id",e)):this.itemToChange="",this.setSelected(this.itemToChange)},restoreTree:function(){d.getElementById("treeRoot")&&(d.getElementById("treeloader").classList.add("visible"),this.setItemToChange(),this.rpcNode=d.getElementById("treeRoot"),modx.post(modx.MODX_MANAGER_URL+"media/style/"+modx.config.theme+"/ajax.php","a=1&f=nodes&indent=1&parent="+modx.tree_parent+"&expandAll=2&id="+this.itemToChange,function(e){modx.tree.rpcLoadData(e),modx.tree.draggable()}))},expandTree:function(){this.rpcNode=d.getElementById("treeRoot"),d.getElementById("treeloader").classList.add("visible"),modx.post(modx.MODX_MANAGER_URL+"media/style/"+modx.config.theme+"/ajax.php","a=1&f=nodes&indent=1&parent="+modx.tree_parent+"&expandAll=1&id="+this.itemToChange,function(e){modx.tree.rpcLoadData(e),modx.tree.saveFolderState(),modx.tree.draggable()})},collapseTree:function(){this.rpcNode=d.getElementById("treeRoot"),d.getElementById("treeloader").classList.add("visible"),modx.post(modx.MODX_MANAGER_URL+"media/style/"+modx.config.theme+"/ajax.php","a=1&f=nodes&indent=1&parent="+modx.tree_parent+"&expandAll=0&id="+this.itemToChange,function(e){modx.openedArray=[],modx.tree.saveFolderState(),modx.tree.rpcLoadData(e),modx.tree.draggable()})},updateTree:function(){this.rpcNode=d.getElementById("treeRoot"),d.getElementById("treeloader").classList.add("visible");var e=d.sortFrm,t="a=1&f=nodes&indent=1&parent="+modx.tree_parent+"&expandAll=2&dt="+e.dt.value+"&tree_sortby="+e.sortby.value+"&tree_sortdir="+e.sortdir.value+"&tree_nodename="+e.nodename.value+"&id="+this.itemToChange+"&showonlyfolders="+e.showonlyfolders.value;modx.post(modx.MODX_MANAGER_URL+"media/style/"+modx.config.theme+"/ajax.php",t,function(e){modx.tree.rpcLoadData(e),modx.tree.draggable()})},getFolderState:function(){var e;if(modx.openedArray!==[0]){e="&opened=";for(var t in modx.openedArray)modx.openedArray[t]&&(e+=t+"|")}else e="&opened=";return e},saveFolderState:function(){modx.post(modx.MODX_MANAGER_URL+"media/style/"+modx.config.theme+"/ajax.php","a=1&f=nodes&savestateonly=1"+this.getFolderState())},showSorter:function(e){e=e||w.event;var t=d.getElementById("floater");e.target.dataset.toggle="#floater",t.classList.toggle("show"),t.onclick=function(e){e.stopPropagation()}},emptyTrash:function(){confirm(modx.lang.confirm_empty_trash)===!0&&modx.get(modx.MODX_MANAGER_URL+"?a=64",function(){modx.tabsClose(modx.tree.deleted),modx.tree.deleted=[],modx.tree.restoreTree()})},showBin:function(e){var t=d.getElementById("treeMenu_emptytrash");if(t)if(e){t.title=modx.lang.empty_recycle_bin,t.classList.remove("disabled"),t.innerHTML=modx.style.icon_trash,t.onclick=function(){modx.tree.emptyTrash()};for(var o=d.getElementById("tree").querySelectorAll(".deleted"),i=0;i<o.length;i++)this.deleted[o[i].dataset.id]="evo-tab-page-"+modx.urlToUid("a=27&id="+o[i].dataset.id)}else t.title=modx.lang.empty_recycle_bin_empty,t.classList.add("disabled"),t.innerHTML=modx.style.icon_trash_alt,t.onclick=null},unlockElement:function(e,t,o){var i=modx.lockedElementsTranslation.msg.replace("[+id+]",t).replace("[+element_type+]",modx.lockedElementsTranslation["type"+e]);confirm(i)===!0&&modx.get(modx.MODX_MANAGER_URL+"?a=67&type="+e+"&id="+t,function(e){1===parseInt(e)?o.parentNode.removeChild(o):alert(e)})},resizeTree:function(){}},removeLocks:function(){confirm(modx.lang.confirm_remove_locks)===!0&&modx.get(modx.MODX_MANAGER_URL+"?a=67",function(){modx.tree.restoreTree()})},keepMeAlive:function(){modx.get("includes/session_keepalive.php?tok="+d.getElementById("sessTokenInput").value+"&o="+Math.random(),function(e){e=JSON.parse(e),"ok"!==e.status&&(w.location.href=modx.MODX_MANAGER_URL+"?a=8")})},updateMail:function(e){try{e&&this.post(modx.MODX_MANAGER_URL,{updateMsgCount:!0},function(e){var t=e.split(","),o=d.getElementById("msgCounter");t[0]>0?o&&(o.innerHTML=t[0],o.style.display="block"):o&&(o.style.display="none"),t[1]>0&&(o=d.getElementById("newMail"),o&&(o.innerHTML='<a href="javascript:;" onclick="modx.tabs({url:\''+modx.MODX_MANAGER_URL+"?a=10',title:'"+modx.lang.inbox+"'});\">"+modx.style.email+modx.lang.inbox+" ("+t[0]+" / "+t[1]+")</a>",o.style.display="block")),modx.config.mail_check_timeperiod>0&&setTimeout("modx.updateMail(true)",1e3*modx.config.mail_check_timeperiod)})}catch(t){setTimeout("modx.updateMail(true)",1e3*modx.config.mail_check_timeperiod)}},openWindow:function(e){"object"!=typeof e&&(e={url:e}),e.width||(e.width=parseInt(.9*w.innerWidth)+"px"),e.height||(e.height=parseInt(.8*w.innerHeight)+"px"),e.left||(e.left=parseInt(.05*w.innerWidth)+"px"),e.top||(e.top=parseInt(.1*w.innerHeight)+"px"),e.title||(e.title=Math.floor(999999*Math.random()+1)),e.url&&(1===this.plugins.EVOmodal?top.EVO.modal.show(e):w.open(e.url,e.title,"width="+e.width+",height="+e.height+",top="+e.top+",left="+e.left+",toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no"))},tabsClose:function(e){if(modx.config.global_tabs&&e)for(var t in e)if(e.hasOwnProperty(t)){var o=d.getElementById(e[t]);o&&(o.firstElementChild.contentWindow.documentDirty=!1,o.close())}},tabs:function(e){function t(e){var t=this;this.url=e.url,this.title=e.title||"",this.name=e.name||"",this.timer=null,this.olduid="",this.closeactions=[6,61,62,63,94],this.saveAndCloseActions=[75,76,86,99,106],this.reload="undefined"!=typeof e.reload?e.reload:1,this.action=modx.getActionFromUrl(e.url),this.getTab=modx.main.getQueryVariable("tab",e.url),this.uid=modx.isDashboard(this.action)?"home":modx.urlToUid(e.url),this.page=d.getElementById("evo-tab-page-"+this.uid),this.row=d.getElementsByClassName("evo-tab-row")[0].firstElementChild,this.tab=d.getElementById("evo-tab-"+this.uid),this.page?"home"===this.uid?this.reload?(this.page.firstElementChild.src=this.url,this.show()):(this.reload=1,null===this.tab.onclick&&(this.tab.onclick=function(e){t.select.call(t,e,this)}),this.tab.show=function(e){t.show.call(t,e)},modx.tabs.selected=this.tab):(this.show(),~this.closeactions.indexOf(this.action)&&(this.setDocPublished(),modx.get(this.url,function(){modx.tree.restoreTree()}))):~this.closeactions.indexOf(this.action)?modx.get(this.url,function(){modx.tree.restoreTree()}):this.create()}if(t.prototype={create:function(){var e=this;modx.main.work(),modx.tabs.selected=this.row.querySelector(".selected"),modx.tabs.selected&&(d.getElementById(modx.tabs.selected.id.replace("tab","tab-page")).classList.remove("show"),modx.tabs.selected.classList.remove("selected")),this.page=d.createElement("div"),this.page.id="evo-tab-page-"+this.uid,this.page.className="evo-tab-page iframe-scroller show",/iPhone|iPad|iPod/i.test(navigator.userAgent)?this.page.innerHTML='<iframe class="tabframes" src="'+this.url+'" name="'+this.name+'" width="100%" height="100%" scrolling="no" frameborder="0"></iframe>':this.page.innerHTML='<iframe class="tabframes" src="'+this.url+'" name="'+this.name+'" width="100%" height="100%" scrolling="auto" frameborder="0"></iframe>',d.getElementById("main").appendChild(this.page),this.page.firstElementChild.onload=function(t){e.onload.call(e,t)},this.tab=d.createElement("h2"),this.tab.id="evo-tab-"+this.uid,this.tab.className="tab selected",this.icon="",/<i/.test(this.title)||(this.icon='<i class="'+modx.setTypeIcon(this.action)+'"></i>'),this.tab.innerHTML='<span class="tab-title" title="'+this.title.replace(/<\/?[^>]+>/g,"")+'">'+this.icon+this.title+'</span><span class="tab-close">×</span>',this.row.appendChild(this.tab),this.tab.onclick=function(t){e.select.call(e,t,this)},this.tab.close=function(t){e.close.call(e,t)},this.tab.show=function(t){e.show.call(e,t)},this.page.close=function(t){e.close.call(e,t)}},onload:function(e){var t=this;w.main=e.target.contentWindow||e.target.defaultView,this.url=w.main.location.href||w.location.hash.substring(1),this.olduid=this.uid,this.uid=modx.urlToUid(this.url);var o=modx.getActionFromUrl(this.url);if(w.main.__alertQuit){w.main.alert=function(){};var i=w.main.document.body.innerHTML;w.main.document.body.style.display="none",history.pushState(null,d.title,modx.isDashboard(modx.getActionFromUrl(w.location.href))?modx.MODX_MANAGER_URL:"#"+w.location.href),w.onpopstate=function(){history.go(1)},modx.popup({type:"warning",title:"Evolution CMS :: Alert",position:"top center alertQuit",content:i,wrap:"body"}),modx.getLockedElements(o,modx.main.getQueryVariable("id",this.url),function(e){e?(t.page.close(),modx.tree.restoreTree()):(w.main.location.href=modx.MODX_MANAGER_URL+t.url,w.history.replaceState(null,d.title,modx.isDashboard(o)?modx.MODX_MANAGER_URL:"#"+t.url))})}else modx.isDashboard(o)||~this.saveAndCloseActions.indexOf(o)&&parseInt(modx.main.getQueryVariable("r",this.url))?this.close(e):this.olduid!==this.uid&&d.getElementById("evo-tab-"+this.uid)?(this.close(e),d.getElementById("evo-tab-"+this.uid).show()):(this.title=w.main.document.body.querySelectorAll("h1")[0]&&w.main.document.body.querySelectorAll("h1")[0].innerHTML||this.title,this.title&&"home"!==this.uid&&(this.tab.innerHTML='<span class="tab-title" title="'+this.title.replace(/<\/?[^>]+>/g,"")+'">'+this.title+'</span><span class="tab-close">×</span>'),this.page.id="evo-tab-page-"+this.uid,this.tab.id="evo-tab-"+this.uid,this.tab.classList.remove("changed"),this.show(),modx.main.onload(e),w.main.document.addEventListener("click",function s(e){"undefined"!=typeof e.view.documentDirty&&e.view.documentDirty&&!t.tab.classList.contains("changed")&&(t.tab.classList.add("changed"),this.removeEventListener(e.type,s,!1))},!1),w.main.document.addEventListener("keyup",function n(e){"undefined"!=typeof e.view.documentDirty&&e.view.documentDirty&&!t.tab.classList.contains("changed")&&(t.tab.classList.add("changed"),this.removeEventListener(e.type,n,!1))},!1))},show:function(){modx.tabs.selected=this.row.querySelector(".selected"),modx.tabs.selected&&modx.tabs.selected!==this.tab&&(d.getElementById(modx.tabs.selected.id.replace("tab","tab-page")).classList.remove("show"),modx.tabs.selected.classList.remove("selected")),this.page.classList.add("show"),this.tab.classList.add("selected"),modx.tabs.selected=this.tab,w.main=this.page.firstElementChild.contentWindow,this.getTab&&76===this.action&&!~w.main.frameElement.contentDocument.location.href.indexOf(this.url)?w.main.frameElement.src=this.url:(w.history.replaceState(null,w.main.document.title,modx.main.getAjaxUrl()),modx.tree.setItemToChange(),modx.main.tabRow.scroll(this.row,this.tab,350))},close:function(e){var t=this.page.firstElementChild.contentWindow.documentDirty,o=!!this.page.firstElementChild.contentWindow.checkDirt;(t&&o&&confirm(this.page.firstElementChild.contentWindow.checkDirt(e))||!t)&&(modx.tabs.selected===this.tab&&(tree.ca="open"),modx.tabs.selected=this.tab.classList.contains("selected")?this.tab.previousElementSibling:this.row.querySelector(".selected"),this.page.parentNode.removeChild(this.page),this.row.removeChild(this.tab),modx.tabs.selected.show())},select:function(e){if("tab-close"===e.target.className)this.close(e);else if(modx.tabs.selected===this.tab){var t=this;this.timer?(clearTimeout(this.timer),this.timer=null,w.main.location.reload()):this.timer=setTimeout(function(){t.timer=null},250)}else this.show()},setDocPublished:function(){var e=w.main.document.getElementsByName("publishedcheck")[0];e&&(e.checked=61===this.action,w.main.document.getElementsByName("published")[0].value=+e.checked),modx.getActionFromUrl(w.main.location.href,3)&&w.main.location.reload()}},modx.config.global_tabs){if("undefined"==typeof e.currentTarget)return new t(e);var o=e;0===o.button&&o.target&&("A"===o.target.tagName&&"main"===o.target.target||o.target.parentNode&&"A"===o.target.parentNode.tagName&&"main"===o.target.parentNode.target)&&(e="A"===o.target.tagName&&o.target||"A"===o.target.parentNode.tagName&&o.target.parentNode,o.shiftKey?modx.openWindow({url:e.href}):modx.tabs({url:e.href,title:e.innerHTML}),o.preventDefault())}else e.url&&(w.main?w.main.frameElement.src=e.url:modx.openWindow(e.url))},popup:function(e){if("object"==typeof e&&(e.url||e.content||e.text)){var t={addclass:"",animation:"fade",content:e.content||e.text||"",clickclose:0,closeall:0,data:"",dataType:"document",delay:5e3,draggable:!1,event:null,height:"auto",hide:1,hover:1,icon:"",iframe:"iframe",margin:".5rem",maxheight:"",method:"GET",overlay:0,overlayclose:0,position:"center",resize:!1,selector:"",showclose:1,target:"main",uid:"",type:"default",title:"",url:"",width:"20rem",wrap:e.wrap||w.main.document.body,zIndex:10500,w:null,show:function(){~t.position.indexOf("center")&&(t.event?(t.el.style.left=t.event.clientX+t.mt+"px",t.el.style.bottom=t.w.innerHeight-t.el.offsetHeight-t.event.clientY+t.mt+"px"):(t.el.style.left=/(%)/.test(t.width)?(100-parseInt(t.width))/2-t.mt/(t.w.innerWidth/100)+"%":(t.w.innerWidth-t.el.offsetWidth)/2-t.mt+"px",t.el.style.bottom=/(%)/.test(t.height)?(100-parseInt(t.height))/2-t.mt/(t.w.innerHeight/100)+"%":(t.w.innerHeight-t.el.offsetHeight-t.wrap.offsetTop)/2-t.mt+"px")),~t.position.indexOf("left")&&(t.el.style.left=0),~t.position.indexOf("right")?t.el.style.right=0:t.el.style.right="auto",~t.position.indexOf("top")?(t.el.style.top=0,t.el.style.bottom=""):t.el.style.top="auto",~t.position.indexOf("bottom")&&(t.el.style.bottom=0),t.calc(),t.el.className+=" in",t.showclose&&(t.el.querySelector(".close").onclick=t.close),t.hide&&(t.el.timer=setTimeout(function(){clearTimeout(t.el.timer),t.close()},t.delay)),t.hover&&(t.el.onmouseenter=function(){clearTimeout(t.el.timer)},t.el.onmouseleave=t.close),t.overlayclose&&t.o&&(t.o.onclick=t.close),t.clickclose&&(t.el.onclick=t.close),t.draggable&&modx.dragging(t.el,{wrap:t.wrap,resize:t.resize}),t.el.classList.add("show")},close:function(e){if(t.event=e||t.event||w.event,t.url&&"iframe"===t.iframe){var o=t.wrap.ownerDocument.querySelectorAll("."+t.className+".in");if(o){var i=t.el.lastElementChild.firstElementChild.contentWindow.documentDirty;(i&&confirm(t.el.lastElementChild.firstElementChild.contentWindow.checkDirt(t.event))||!i)&&(t.el.classList.remove("in"),t.animation||t.el.classList.remove("show"),t.calc(1),t.o&&t.o.parentNode&&(t.o.parentNode.removeChild(t.o),t.wrap.style.overflow=""),t.el.timer=setTimeout(function(){clearTimeout(t.el.timer),t.el.parentNode&&t.el.parentNode.removeChild(t.el)},200))}}else t.el.classList.remove("in"),t.animation||t.el.classList.remove("show"),t.calc(1),t.o&&t.o.parentNode&&(t.o.parentNode.removeChild(t.o),t.wrap.style.overflow=""),t.el.timer=setTimeout(function(){clearTimeout(t.el.timer),t.el.parentNode&&t.el.parentNode.removeChild(t.el)},200);"function"==typeof t.onclose&&t.onclose(e,t.el)},calc:function(e){var o=t.wrap.ownerDocument.querySelectorAll("."+t.className+'.in[data-position="'+t.el.dataset.position+'"]');if(o&&o.length){t.els=[];for(var i=0;i<o.length;i++)t.els.push(o[i]);for(t.els.sort(function(e,t){return e.index-t.index}),t.t=0,0===t.position.indexOf("center")?t.t=e?(t.w.innerHeight-t.els[t.els.length-1].offsetHeight)/2-t.mt:(t.w.innerHeight+t.el.offsetHeight)/2:t.t=e?0:t.el.offsetHeight+t.mt,i=t.els.length;i--;)t.wrap.ownerDocument.getElementById(t.els[i].id).index=i-t.els.length,~t.position.indexOf("top")?t.wrap.ownerDocument.getElementById(t.els[i].id).style.top=t.t+"px":t.wrap.ownerDocument.getElementById(t.els[i].id).style.bottom=t.t+"px",t.t+=t.els[i].offsetHeight+t.mt,t.closeall&&t.el!==o[i]&&t.els[i].close()}},onclose:function(){}};for(var o in e)e.hasOwnProperty(o)&&"undefined"!=typeof t[o]&&(t[o]=e[o]);if(t.timer=0,t.position=t.position.split(" "),modx.popupLastIndex?t.zIndex=modx.popupLastIndex++:modx.popupLastIndex=t.zIndex,t.uid=e.url?modx.urlToUid(e.url):modx.toHash(e),t.className="evo-popup","string"==typeof t.wrap&&(t.wrap=d.querySelector(t.wrap)),t.w=t.wrap.ownerDocument.defaultView||t.wrap.ownerDocument.parentWindow,t.overlay&&(t.wrap.querySelector(".evo-popup-overlay")?(t.o=t.wrap.querySelector(".evo-popup-overlay"),t.o.style.zIndex=t.zIndex-1):(t.o=d.createElement("div"),t.o.className="evo-popup-overlay",t.o.style.zIndex=t.zIndex-1,t.wrap.appendChild(t.o),t.wrap.style.overflow="hidden")),t.el=t.wrap.ownerDocument.getElementById("evo-popup-"+t.uid),t.el)clearTimeout(t.el.timer),t.el.index=0,t.el.classList.remove("in"),t.el.classList.add("show"),t.el.style.zIndex=t.zIndex,t.el.dataset.position=t.position.join(":"),t.mt=parseFloat(getComputedStyle(t.el).marginTop),t.el.close=t.close,t.show();else if(t.el=d.createElement("div"),t.el.id="evo-popup-"+t.uid,t.el.close=t.close,t.el.index=0,t.el.style.position="fixed",t.el.style.width=/[^[0-9]/.test(t.width)?t.width:t.width+"px",t.el.style.height=/[^[0-9]/.test(t.height)?t.height:t.height+"px",t.el.style.zIndex=t.zIndex,t.el.style.margin=t.margin,t.el.className=t.className+" alert alert-"+t.type+" "+t.addclass+(t.animation?" animation "+t.animation:""),t.el.dataset.position=t.position.join(":"),t.showclose&&(t.el.innerHTML+='<div class="evo-popup-close close">&times;</div>'),t.title&&(t.header=document.createElement("div"),"none"!==t.icon&&(t.header.innerHTML+='<i class="fa fa-fw '+(t.icon?t.icon:"fa-"+t.type)+'"></i>'),t.header.innerHTML+=t.title,t.header.className="evo-popup-header",t.el.appendChild(t.header)),t.el.innerHTML+='<div class="evo-popup-body"></div>',t.wrap.appendChild(t.el),t.mt=parseFloat(getComputedStyle(t.el).marginTop),t.maxheight&&(t.maxheight=/(%)/.test(t.maxheight)?(t.w.innerHeight-t.el.offsetHeight-t.mt)/100*parseInt(t.maxheight):t.maxheight,t.el.lastChild.style.overflowY="auto",t.el.lastChild.style.maxHeight=t.maxheight+"px"),t.url)if(t.draggable=1,"iframe"===t.iframe)t.resize=1,t.uid=modx.urlToUid(e.url),t.el.className+=" "+t.addclass+" "+t.className+"-iframe",t.el.id="evo-popup-"+t.uid,d.getElementById("mainloader").className="show",t.frame=d.createElement("iframe"),t.frame.width="100%",t.frame.height="100%",t.frame.frameBorder="0",t.frame.src=t.url,t.frame.onload=function(o){o.target.contentWindow.opener=t.w,e.url=o.target.contentWindow.location.href,t.uid=modx.urlToUid(e.url),t.event=o,o.target.contentWindow.__alertQuit?(modx.popup({type:"warning",title:"Evolution CMS :: Alert",position:"top center alertQuit",content:o.target.contentWindow.document.body.querySelector("p").innerHTML}),o.target.contentWindow.document.body.innerHTML="",o.target.contentWindow.alert=function(){}):modx.isDashboard(modx.getActionFromUrl(e.url))||t.wrap.querySelectorAll("#evo-popup-"+t.uid).length>1?t.el.close():(o.target.contentDocument.querySelectorAll("h1")[0]?e.title=o.target.contentDocument.querySelectorAll("h1")[0].innerHTML:o.target.contentDocument.title&&(e.title=o.target.contentDocument.title),t.header&&(o.target.offsetParent.offsetParent.getElementsByClassName(t.header.className)[0].innerHTML=e.title),o.target.offsetParent.offsetParent.id="evo-popup-"+t.uid,o.target.offsetParent.offsetParent.classList.remove("changed")),o.target.contentWindow.close=t.close,modx.main.stopWork()},t.el.lastChild.appendChild(t.frame),t.show();else{var i=new XMLHttpRequest;i.open(t.method,t.url,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded;"),i.setRequestHeader("X-REQUESTED-WITH","XMLHttpRequest"),t.dataType&&(i.responseType=t.dataType),i.onload=function(){if(4===this.readyState){if(t.el.className+=" "+t.className+"-ajax","document"===t.dataType)if(t.selector){var e=this.response.documentElement.querySelector(t.selector);e&&(t.el.lastChild.innerHTML+=e.innerHTML)}else t.el.lastChild.innerHTML+=this.response.body.innerHTML;else t.el.lastChild.innerHTML+=this.response;t.show()}},i.send(t.data)}else t.el.lastChild.innerHTML+=t.content,t.show();return t}},getWindowDimension:function(){var e=0,t=0,o=d.documentElement,i=d.body;return"number"==typeof w.innerWidth?(e=w.innerWidth,t=w.innerHeight):o&&(o.clientWidth||o.clientHeight)?(e=o.clientWidth,t=o.clientHeight):i&&(i.clientWidth||i.clientHeight)&&(e=i.clientWidth,t=i.clientHeight),{width:e,height:t}},hideDropDown:function(e){if(e=e||w.event||w.main.event,"open"!==tree.ca&&""!==tree.ca||modx.tree.setSelectedByContext(),null!==modx.tree.ctx&&(d.getElementById(modx.frameset).removeChild(modx.tree.ctx),modx.tree.ctx=null),!/dropdown\-item/.test(e.target.className)){var t,o=d.querySelectorAll(".dropdown.show"),i=null,s=e.target||e.target.parentNode;for("undefined"!=typeof s.dataset.toggle?i=d.querySelector(s.dataset.toggle):s.classList.contains("dropdown-toggle")&&(i=s.offsetParent),t=0;t<o.length;t++)i!==o[t]&&o[t].classList.remove("show");for(o=w.main&&w.main.document.querySelectorAll(".dropdown.show")||[],t=0;t<o.length;t++)i!==o[t]&&o[t].classList.remove("show")}},XHR:function(){return"XMLHttpRequest"in w?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},get:function(e,t,o){var i=this.XHR();i.open("GET",e,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o&&(i.responseType=o),i.onload=function(){return 200===this.status&&"function"==typeof t?t(this.response):void 0},i.send()},post:function(e,t,o,i){var s=this.XHR(),n="";if("function"==typeof t)i=o,o=t;else if("object"==typeof t){var a,r=[],l=0;for(a in t)t.hasOwnProperty(a)&&(r[l++]=a+"="+t[a]);n=r.join("&")}else"string"==typeof t&&(n=t);s.open("POST",e,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),s.setRequestHeader("X-REQUESTED-WITH","XMLHttpRequest"),i&&(s.responseType=i),s.onload=function(){return 4===this.readyState&&o!==u?o(this.response):void 0},s.send(n)},pxToRem:function(e){return e/parseInt(w.getComputedStyle(d.documentElement).fontSize)},remToPx:function(e){return e*parseInt(w.getComputedStyle(d.documentElement).fontSize)},toHash:function(e){e=String(JSON.stringify(e));var t,o,i=0;if(0===e.length)return i;for(o=0;o<e.length;o++)t=e.charCodeAt(o),i=(i<<5)-i+t,i&=i;return Math.abs(i).toString()},urlToUid:function(e){var t,o="";return e&&(t=modx.getActionFromUrl(e),t&&(o+=modx.typesactions[t]?"&type="+modx.typesactions[t]:"&a="+t),modx.main.getQueryVariable("id",e)&&(o+="&id="+modx.main.getQueryVariable("id",e)),modx.main.getQueryVariable("type",e)&&(o+="&type="+modx.main.getQueryVariable("type",e)),o=modx.toHash(o)),o},getActionFromUrl:function(e,t){var o=parseInt(modx.main.getQueryVariable("a",e));return isNaN(o)&&(o=e.replace(modx.MODX_MANAGER_URL,""),o=o.match(/^\#/)?o.replace(/^\#/,""):o.replace(/\#.+$/,""),o=o.replace(/\?.+$/,""),""==o&&(o="/")),"undefined"!=typeof t?o===parseInt(t):o},isDocument:function(e){return 27==e},isDashboard:function(e){return 2==e||"/"==e},getLockedElements:function(e,t,o){modx.typesactions[e]&&t&&modx.post(modx.MODX_MANAGER_URL+"media/style/"+modx.config.theme+"/ajax.php",{a:"getLockedElements",id:modx.main.getQueryVariable("id",w.main.location.search),type:modx.typesactions[modx.getActionFromUrl(w.main.location.href)]},o)},dragging:function(e,t){return this.dragging.init=function(e,t){var o={resize:!1,minWidth:50,minHeight:50,wrap:document,opacity:"0.65",classDrag:"drag",classResize:"resize",handler:"",onstart:function(){},onstop:function(){},ondrag:function(){},onresize:function(){}},i={x:0,y:0,elmX:0,elmY:0,border:5,isdrag:!1,isresize:!1,onTop:0,onLeft:0,onRight:0,onBottom:0,handlerHeight:e.offsetHeight,borders:document.createElement("div")},s=modx.extend(this,o,t,i);this.el=e,this.borders.className="border-outline",this.borders.innerHTML='<i class="bo-left"></i><i class="bo-top"></i><i class="bo-right"></i><i class="bo-bottom"></i>',this.classDrag&&this.el.classList.add(this.classDrag),this.classResize&&this.el.classList.add(this.classResize),this.el.insertBefore(this.borders,this.el.firstChild),this.handler&&this.el.getElementsByClassName(this.handler)[0]&&(this.handler=this.el.getElementsByClassName(this.handler)[0],this.handlerHeight=this.handler.offsetHeight),this.el.onmousedown=function(e){s.mousedown(e)},this.el.ontouchstart=function(e){s.mousedown(e.changedTouches[0])},this.wrap.addEventListener("mousemove",function(e){s.calc(e)},!1),this.wrap.addEventListener("touchmove",function(e){s.calc(e.changedTouches[0])},!1)},this.dragging.init.prototype={mousedown:function(e){if(!e.target.classList.contains("close")){e=document.all?window.event:e;var t=this,o=document.all?window.event.clientX:e.clientX,i=document.all?window.event.clientY:e.clientY,s=w.getComputedStyle(this.el);this.elmX=o-this.el.offsetLeft+parseInt(s.marginLeft),this.elmY=i-this.el.offsetTop+parseInt(s.marginTop),this.el.position=this.el.getBoundingClientRect(),this.el.style.position="fixed",this.el.style.transitionDuration="0s",this.el.style.webkitTransitionDuration="0s",this.el.style.left=this.el.offsetLeft-parseInt(s.marginLeft)+"px",this.el.style.top=this.el.offsetTop-parseInt(s.marginTop)+"px",this.el.style.right="auto",this.el.style.bottom="auto",this.el.style.width=this.el.position.width+"px",this.el.style.height=this.el.position.height+"px",e.target.parentNode===this.borders?(this.isresize=this.resize,this.el.classList.add("is-resize")):(!this.handler||this.handler&&e.target===this.handler)&&(this.isdrag=!0,this.el.classList.add("is-drag")),"function"==typeof this.start&&this.onstart(e,this.el),e.preventDefault?e.preventDefault():document.onselectstart=function(){return!1},this.wrap.onmousemove=function(e){t.mousemove(e)},this.wrap.ontouchmove=function(e){t.mousemove(e.changedTouches[0]),e.stopPropagation()},this.wrap.onmouseup=function(e){t.mouseup(e)},this.wrap.ontouchend=function(e){t.mouseup(e.changedTouches[0]),e.stopPropagation()}}},mousemove:function(e){var t=document.all?window.event.clientX:e.clientX,o=document.all?window.event.clientY:e.clientY;if(this.isresize){if(this.onRight&&(this.el.style.width=Math.max(t-this.el.position.left+(this.el.position.width-this.x),this.minWidth)+"px"),this.onBottom&&(this.el.style.height=Math.max(o-this.el.position.top+(this.el.position.height-this.y),this.minHeight)+"px"),this.onLeft&&(this.width=Math.max(this.el.position.left-t+this.el.position.width+this.x,this.minWidth),this.width>this.minWidth&&(this.el.style.width=this.width+"px",this.el.style.left=t-this.elmX+"px")),this.onTop){var i=Math.max(this.el.position.top-o+this.el.position.height+this.y,this.minHeight);i>this.minHeight&&(this.el.style.height=i+"px",this.el.style.top=o-this.elmY+"px")}"function"==typeof this.onresize&&this.onresize(e,this.el)}else this.isdrag&&(this.el.style.opacity=this.opacity,this.el.style.left=t-this.elmX+"px",this.el.style.top=o-this.elmY+"px","function"==typeof this.drag&&this.ondrag(e,this.el))},mouseup:function(e){(this.isdrag||this.isresize)&&(this.el.classList.remove("is-resize"),this.el.classList.remove("is-drag"),this.el.style.opacity="",this.el.style.transitionDuration="",this.el.style.webkitTransitionDuration="",this.el.position=this.el.getBoundingClientRect(),this.isdrag=!1,this.isresize=!1,this.wrap.onmousemove=null,this.wrap.onselectstart=null,"function"==typeof this.stop&&this.onstop(e,this.el))},calc:function(e){this.isresize||this.isdrag||(this.x=e.clientX-this.el.offsetLeft,this.y=e.clientY-this.el.offsetTop,this.resize?(this.onTop=this.y<this.border,this.onLeft=this.x<this.border,this.onRight=this.x>=this.el.offsetWidth-this.border,this.onBottom=this.y>=this.el.offsetHeight-this.border,this.onRight&&this.onBottom||this.onLeft&&this.onTop?this.el.style.cursor="nwse-resize":this.onRight&&this.onTop||this.onBottom&&this.onLeft?this.el.style.cursor="nesw-resize":this.onRight||this.onLeft?this.el.style.cursor="ew-resize":this.onBottom||this.onTop?this.el.style.cursor="ns-resize":this.x>0&&this.y>0&&this.x<this.el.offsetWidth&&this.y<=this.handlerHeight&&this.y>=this.border?this.el.style.cursor="move":this.el.style.cursor="default"):this.x>0&&this.y>0&&this.x<this.el.offsetWidth&&this.y<=this.handlerHeight&&this.y>=this.border&&(this.el.style.cursor="move"))}},new this.dragging.init(e,t)},setTypeIcon:function(e){var t="";switch(this.typesactions[e]){case 1:t=modx.style.icon_template;break;case 2:t=modx.style.icon_tv;break;case 3:t=modx.style.icon_chunk;break;case 4:t=modx.style.icon_code;break;case 5:t=modx.style.icon_plugin;break;case 6:t=modx.style.icon_element;break;case 7:t=modx.style.icon_edit;break;default:t=modx.style.icon_circle}return t}}),w.mainMenu={},w.mainMenu.stopWork=function(){modx.main.stopWork()},w.mainMenu.work=function(){modx.main.work()},w.mainMenu.reloadtree=function(){modx.plugins.ElementsInTree&&setTimeout("reloadElementsInTree()",50),modx.config.global_tabs&&setTimeout("modx.tree.restoreTree()",100)},w.mainMenu.startrefresh=function(e){9===e&&modx.tree.restoreTree(),10===e&&(w.location.href=modx.MODX_MANAGER_URL)},w.mainMenu.startmsgcount=function(e,t,o){modx.updateMail(o)},w.mainMenu.hideTreeFrame=function(){modx.resizer.setWidth(0)},w.mainMenu.defaultTreeFrame=function(){modx.resizer.setDefaultWidth()},w.tree={},w.tree.ca="open",w.tree.document=document,w.tree.saveFolderState=function(){},w.tree.updateTree=function(){modx.tree.updateTree()},w.tree.restoreTree=function(){modx.tree.restoreTree()},w.tree.resizeTree=function(){},w.onbeforeunload=function(){var e=w.main.frameElement.contentWindow;modx.isDocument(modx.getActionFromUrl(e.location.href))&&modx.get(modx.MODX_MANAGER_URL+"?a=67&type=7&id="+modx.main.getQueryVariable("id",e.location.search.substring(1)))},d.addEventListener("DOMContentLoaded",function(){modx.init()})}("undefined"!=typeof jQuery?jQuery:"",window,document,void 0),function(){Element.prototype.closest||(Element.prototype.closest=function(e){var t,o,i=this;if(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].some(function(e){return"function"==typeof document.body[e]?(t=e,
!0):!1}),i&&t&&i[t](e))return i;for(;i;){if(o=i.parentElement,o&&t&&o[t](e))return o;i=o}return null})}();
